\note{Having them come up with how to generalize differential notation to higher dimensions, and then use differential notation as well, was too much. Perhaps I need one more problem right shortly after 6.22.  In 6.22, the students are taking differential notation and from it writing a matrix (it's how they discover the derivative).  What I need is to have the students write differential notation in terms of a matrix.  Perhaps this would be best after 6.24.  We're already finished with derivatives, so I'll put a note to myself to polish this up next semester. See my notes at the end as well.}


%There's a link in this file to dropbox.  Rather than have to hunt for it later, here it is.
\newcommand{\derivativehomeworklink}[1]{\href{http://db.tt/cSeKG8XO}{#1}}%
%
%
\noindent 
This unit covers the following ideas. In preparation for the quiz and exam, make sure you have a lesson plan containing examples that explain and illustrate the following concepts.  
\begin{enumerate}
\item Find limits, and be able to explain when a function does not have a limit by considering different approaches.
\item Compute partial derivatives. Explain how to obtain the total derivative from the partial derivatives (using a matrix).
\item Find equations of tangent lines and tangent planes to surfaces. We'll do this three ways.
\item Find derivatives of composite functions, using the chain rule (matrix multiplication).
\end{enumerate}
You'll have a chance to teach your examples to your peers prior to the exam.

\section{Limits}
In first semester calculus, you learned how to compute limits of functions. We need to define limits before proceeding. One possible definition of a limit follows.
\begin{definition}
 Let $f:\R\to\R$ be a function.
 We write $\ds \lim_{x\to c} f(x)=L$ if and only if for every $\epsilon>0$, there exists a $\delta>0$ such that $0<|x-c|<\delta$ implies $|f(x)-L|<\epsilon$.
\end{definition}
 This formal definition is studied extensively in upper division math classes. We're looking at it here because we need to compare it with the formal definition of limits in higher dimensions. The only difference: just put vector symbols above the input $x$ and the output $f(x)$.
\begin{definition}
 Let $\vec f:\R^n\to\R^m$ be a function.
 We write $\ds \lim_{\vec x\to \vec c} \vec f(\vec x)=\vec L$ if and only if for every $\epsilon>0$, there exists a $\delta>0$ such that $0<|\vec x-\vec c|<\delta$ implies $|\vec f(\vec x)-\vec L|<\epsilon$.
\end{definition}
We'll find that throughout this unit, the key difference between first semester calculus and this course is that we replace input and output of functions with vectors. 
 
\begin{problem}
 For the function $f(x,y)=z$, we can write $f$ in the vector notation $\vec y=\vec f(\vec x)$ if we let $\vec x=(x,y)$ and $\vec y=(z)$. Notice that $\vec x$ is a vector of inputs, and $\vec y$ is a vector of outputs. 
 For each of the functions below, state what $\vec x$ and $\vec y$ should be so that the function can be written in the form $\vec y = \vec f (\vec x)$. \marginpar{The point to this problem is to help you learn to recognize the dimensions of the domain and codomain of the function.  If we write $\vec f:\R^n\to \R^m$, then $\vec x$ is a vector in $\R^n$ with $n$ components, and $\vec y$ is a vector in $\R^m$ with $m$ components.}  
\begin{enumerate}
 \item $f(x,y,z)=w$
 \item $\vec r(t)=(x,y,z)$
 \item $\vec r(u,v)=(x,y,z)$
 \item $\vec F(x,y)=(M,N)$
 \item $\vec F(\rho,\phi,\theta)=(x,y,z)$
\end{enumerate}
\end{problem}


You learned to work with limits in first semester calculus without needing the formal definitions above. The following problem has you review some of what you did in first semester calculus.
\begin{problem}\marginpar{See 14.2: 1-30 for more practice.}%
 Compute each of the following limits, or state why the limit does not exist. Do these problems without using L'Hopital's rule, as there is not a good substitute for L'Hopital's rule in higher dimensions. \note{check this.}
\begin{enumerate}
 \item $\ds\lim_{x\to 3}\frac{x^2-9}{x-3}$
 \item $\ds\lim_{(x,y)\to (2,1)} 9-x^2-y^2$
 \item $\ds\lim_{(x,y)\to (4,4)} \frac{x-y}{x^2-y^2}$
 \item $\ds\lim_{x\to 0}\frac{x}{|x|}$ [Hint: graph the function.]
\end{enumerate}
\end{problem}

You should have observed that all the limits above existed, except for the last one.  You can show that limit does not exist by considering what happens from the left, and comparing it to what happens on the right.  In first semester calculus you used the following theorem extensively. 
\begin{quote}
 If $y=f(x)$ is a function defined on some open interval containing $c$, then $\ds\lim_{x\to c}f(x)$ exists if and only if  $\ds\lim_{x\to c^-}f(x) = \ds\lim_{x\to c^+}f(x)$.
\end{quote}
 A limit exists precisely when the limits from every direction exists, and all directional limits are equal. In first semester calculus, this required that you check 2 directions. This theorem generalizes to higher dimensions, however it becomes much more difficult to apply. The following problem will show you why.
\begin{problem}
 Consider the function $\ds f(x,y)=\frac{x^2-y^2}{x^2+y^2}$.
 \marginpar{You may want to look at a graph (in \href{http://www.wolframalpha.com/input/?i=plot+\%28x^2-y^2\%29\%2F\%28x^2\%2By^2\%29}{Wolfram Alpha}). As you compute each limit, make sure you understand what that limit means in the graph. Try using the ``contour lines'' option on the 3D surface graph.}
Our goal is to determine if the function has a limit at $(0,0)$.
\begin{enumerate}
 \item In the $xy$-plane, how many ways are there to approach the point $(0,0)$? Give a few examples.
 \item One approach to the origin is to travel along the $x$-axis (so $y=0$). Using this approach, compute the limit 
$$\ds\lim_{\text{\footnotesize $\begin{array}{c}(x,y)\to(0,0)\\ y=0\end{array}$}}\frac{x^2-y^2}{x^2+y^2} = \lim_{x\to 0} \frac{x^2-0^2}{x^2-0^2}.$$
 \item Another approach to the origin is to travel along the $y$-axis (so let $x=0$). Compute the limit along this approach, namely 
$\ds\lim_{\text{\footnotesize $\begin{array}{c}(x,y)\to(0,0)\\ x=0\end{array}$}}\frac{x^2-y^2}{x^2+y^2}$.
 \item Another approach is to travel along the line $y=x$.  What is the limit at $(0,0)$ along this approach?
 \item Does this function have a limit at $(0,0)$? Explain. \marginpar{See 14.2: 41-50 for more practice.}%
\end{enumerate}
\end{problem}

The theorem from first semester calculus generalizes as follows.
\begin{quote}
 If $\vec y=\vec f(\vec x)$ is a function defined on some open region containing $\vec c$, then $\ds\lim_{\vec x\to \vec c}\vec f(\vec x)$ exists if and only if the limit exists along every possible approach to $\vec c$, and the all these limits are equal.
\end{quote}
There's a fundamental problem with using this theorem to determine if a limit exists. Once the domain is 2 dimensional or higher, there are infinitely many ways to approach a point. There is no longer just a left and right side. So you can prove a limit exists, provided you can check infinitely many cases. That's the problem; checking infinitely many cases takes a really long time.  The theorem can be used to show that a limit does not exists.  All you have to do is find two approaches with different limits.

\begin{problem}\marginpar{See 14.2: 41-50 for more practice.}%
 Consider the function $\ds f(x,y) = \frac{xy}{x^2+y^2}$.  Does this function have a limit at $(0,0)$?  Examine the function at $(0,0)$ by considering multiple approaches (feel free to use the same ones as above). 
\end{problem}

\begin{problem}
 Consider the function $f(x,y) = \frac{xy}{x^2+y^2}$.  Compute the limit at $(0,0)$ along the approaches $y=mx$ (this takes care of every line through the origin, except $x=0$).  Then compute the limit at $(0,0)$ along the approach $y=x^2$.
\end{problem}

\begin{problem}[Challenge]
 Give an example of a function $f(x,y)$ so that the limit at $(0,0)$ along every straight line $y=mx$ exists and equals 0.  However, show that the function has no limit at $(0,0)$ by considering an approach that is not a straight line.
\end{problem}


\section{Partial Derivatives}

Recall from first semester calculus the following definition of the derivative.
\begin{dfn}
We define the derivative of a function $f$ at $x$ to be the limit
$$f'(x)=\frac{d}{dx}[f(x)]=\lim_{h\to 0}\frac{f(x+h)-f(x)}{h},$$
provided the limit exists. Whether you write $f'$ or $\frac{df}{dx}$ does not matter, as they both represent the same thing.  The notation $\frac{df}{dx}$ leads to the differential notation $dy=f'dx$, which we will use to generalize the derivative to all dimensions.
\end{dfn}
Before discussing the derivative of a function in higher dimensions, we first define partial derivatives. A matrix of partial derivatives will make up the total derivative.
\begin{dfn}[Partial Derivative]
 Let $f$ be a function.  The partial derivative of $f$ with respect to $x$ is the regular derivative of $f$, provided we hold all input variables constant except $x$.  If $f=f(x,y,z)$, we write any of 
 $$\frac{\partial f}{\partial x}=\frac{\partial}{\partial x}[f]=f_x = D_x f=\lim_{h\to 0}\frac{f(x+h,y,z)-f(x,y,z)}{h}$$
to mean the partial of $f$ with resepect to $x$.
 The partial of $f$ with respect to $y$, written $\ds \frac{\partial f}{\partial y}=f_y$, is the regular derivative of $f$, provided we hold all input variables constant except $y$. A similar definition holds for partials with respect to any variable.
\end{dfn}

\begin{problem}\marginpar{See 14.3: 1-40 for more practice. I strongly suggest you practice a lot of this type of problem until you can compute partial derivatives with ease.}%
 Find the indicated partial derivatives.
\begin{enumerate}
 \item For $f(x,y)=x^2+2xy+3y^2$ find $\ds\frac{\partial f}{\partial x}$ and $f_y$.
 \item For $f(x,y,z)=x^2y^3z^4$, find $f_x$, $\ds\frac{\partial f}{\partial y}$ and $D_z f$.
 \item For $\vec r(u,v) = (u,v,v\cos(uv))$, find $\ds\frac{\partial \vec r}{\partial u}$ and $\ds\frac{\partial \vec r}{\partial v}$. 
 \item For $\vec F(x,y) = (-y,xe^{3y})$, find $\ds\frac{\partial \vec F}{\partial x}$ and $\ds\frac{\partial \vec F}{\partial y}$.
\end{enumerate}
\end{problem}

Since a partial derivative is a function, you can take partial derivatives of that function as well.  If you want to first compute a partial with respect to $x$, and then with respect to $y$, you would write $$f_{xy}=\ds\frac{\partial}{\partial y}\frac{\partial}{\partial x}f = \frac{\partial}{\partial y}\frac{\partial f}{\partial x} = \frac{\partial^2 f}{\partial y \partial x}.$$
The shorthand notation $f_{xy}$ is obviously the easiest to write, but in upper level courses we will use subscripts to mean other things. At that point, we'll use the fractional partial notation to avoid confusion.


\begin{problem}\label{second partials agree}
Consider the function $f(x,y)=3xy^3+e^{x^2}.$
\begin{enumerate}
 \item Compute the second partials $\ds \frac{\partial^2 f}{ \partial x^2}$, $\ds\frac{\partial^2 f}{\partial y \partial x}$, $\ds\frac{\partial^2 f}{\partial y^2}$, and $\ds\frac{\partial^2 f}{\partial x \partial y}$.
 \item For $f(x,y)=x^2+2xy+y^3$, compute both $f_{xy}$ and $f_{yx}$.  
 \item Make a conjecture about a relationship between $f_{xy}$ and $f_{yx}$.
 \item Use your conjecture to quickly compute $f_{xy}$ if $$f(x,y)=\tan^{1}(\cos(x))\cdot (x^{49}+x)^{1000}+3xy.$$ 
\end{enumerate}
\end{problem}



The next problem will help you visualize what a partial derivative means in the graph of a surface.
\begin{problem} \label{cake introduction}
 Consider the function $f(x,y)=9-x^2-y^2$.  Start by constructing a 3D surface plot of $f$ (done in \ref{surface graph for a function of two variables}). We'll focus on the point $(2,1)$.
\begin{enumerate}
 \item Let $y=1$ and construct a graph in the $xz$ plane of the curve $z=9-x^2-1^2$. Find an equation of the tangent line to this curve at $x=2$. Write the equation in the form $(z-z_0)=m(x-x_0)$.
 \item Let $x=2$ and construct a graph in the $yz$ plane of the curve $z=9-2^2-y^2$. Find an equation of the tangent line to this curve at $y=1$. Write the equation in the form $(z-z_0)=m(y-y_0)$.
 \item Compute $f_x$ and $f_y$ and then evaluate each at $(2,1)$.  What does this have to do with the previous two parts?
 \item If the slope of a line $y=mx+b$ is $m$, then we know that an increase of $1$ unit in the $x$ direction will increase $y$ by $m$ units. Fill in the blanks, as they relate to the function $f(x,y)=9-x^2-y^2$ and the lines above.
\begin{itemize}
 \item Increasing $x$ by 1 unit when $y$ does not change will cause $z$ to increase by about \rule{1cm}{1pt} units.
 \item Increasing $y$ by 1 unit when $x$ does not change will cause $z$ to increase by about \rule{1cm}{1pt} units.
\end{itemize}
\end{enumerate}
\end{problem}

Once we have partial derivatives, we have tangent lines to a surface. This means we can find tangent planes as well.
\begin{problem} \label{cake plane introduction}\marginpar{See 14.6: 9-12 for more practice.}%
 Consider the function $f(x,y)=9-x^2-y^2$ at the point $(2,1)$. From the previous problem, we know that increasing $x$ by 1 unit when $y$ does not change will cause $z$ to increase by about $f_x$ units. In terms of vectors, we have $(\Delta x, \Delta y, \Delta z) = (1,0,f_x)$ is a tangent vector to the surface. 
\begin{enumerate}
 \item At the point $(2,1)$ find a tangent vector to the surface in the $x$ direction (so compute $f_x(2,1)$ and put it in the vector $(1,0,f_x)$). Then give a vector equation of the tangent line to $f$ in the $x$ direction.
 \item At the point $(2,1)$ find a tangent vector to the surface in the $y$ direction. 
Then give a vector equation of the tangent line to $f$ in the $y$ direction.
 \item Give an equation of the tangent plane to $f$ at $(2,1)$. 
\end{enumerate}
\end{problem}

This problem will show you how parametrizations can simplify the process of finding tangent vectors.
\begin{problem}\marginpar{See 16.5: 27-30 for more practice.}%
 Again, consider the function $f(x,y)=9-x^2-y^2$ at the point $(2,1)$. A parametrization of this surface is $\vec r(x,y) = (x,y,9-x^2-y^2)$. We'll use the parametrization to find an equation for the tangent plane.
\begin{enumerate}
 \item Compute $\ds\frac{\partial \vec r}{\partial x}(2,1)$. Then give a vector equation of the tangent line to $f$ in the $x$ direction.
 \item Compute $\ds\frac{\partial \vec r}{\partial y}(2,1)$. Then give a vector equation of the tangent line to $f$ in the $y$ direction.
 \item Give an equation of the tangent plane to $f$ at $(2,1)$. 
\end{enumerate}
\end{problem}

\begin{problem}\marginpar{See 14.6: 9-12 for more practice.}%
 Let $f(x,y)=x^2+4xy+y^2$.  Give two vector equations of tangent lines to the surface at $(3,-1)$. Then give an equation of the tangent plane.
\end{problem}

\begin{problem}\marginpar{See 16.5: 27-30 for more practice.}%
 Consider the cone parametrized by $\vec r(u,v)=(u\cos v, u\sin v,u)$.  Give vector equations of two tangent lines to the surface at $(2,\pi/2)$. Then give an equation of the tangent plane.
\end{problem}

\begin{problem}\label{general tangent plane with partials}\marginpar{Page 811 has the answer, but written in a slightly different form than you will get. In addition, they arrive at the solution in a completely different way. }%%
 Recall that an equation of the tangent line to $y=f(x)$ at $x=c$ is $y-f(c)=f'(c)(x-c)$. Let $z=f(x,y)$ be a function whose partial derivatives exist. Give two vectors tangent to the surface at $(x,y)=(a,b)$.  Then given an equation of the tangent plane to the surface at $(a,b)$.  What is a normal vector to the surface?
\end{problem}

\section{The Derivative}
\begin{remark}
 In problem \ref{cake introduction}, we learned the following for  $z=f(x,y)$.
\begin{itemize}
 \item Increasing $x$ by 1 unit when $y$ remains constant will cause $z$ to increase by about $f_x$ units.
 \item Increasing $y$ by 1 unit when $x$ remains constant will cause $z$ to increase by about $f_y$ units.
\end{itemize}
We will use these facts to introduce differential notation for functions of several variables, and then define the total derivative as a matrix of partial derivatives.
\end{remark}

\begin{problem}
 Fill in the blanks. For this example, consider the function $z=f(x,y)$.
\begin{itemize}
 \item Increasing $x$ by $\frac{1}{2}$ when $\Delta y=0$ will cause $z$ to increase by about \rule{1cm}{1pt}.
 \item Increasing $y$ by $\frac{1}{10}$ when $\Delta x=0$ will cause $z$ to increase by about \rule{1cm}{1pt}.
 \item If $\Delta x=\frac{1}{2}$ and $\Delta y=\frac{1}{10}$ then $\Delta z\approx$ \rule{2cm}{1pt}. [Hint: sum the errors.]
 \item Increasing $x$ by $dx$ when $\Delta y=0$ will cause $z$ to increase by about \rule{1cm}{1pt}.
 \item Increasing $y$ by $dy$ when $\Delta x=0$ will cause $z$ to increase by about \rule{1cm}{1pt}.
 \item If $\Delta x=dx$ and $\Delta y=dy$ then $\Delta z\approx$ \rule{2cm}{1pt}.
\end{itemize}
\end{problem}

Based on the answer from the previous problem, we define the following.
\begin{definition}
In first semester calculus, if $y=f(x)$, we defined the differential of $f$ to be
$$df = \frac{df}{dx},$$ where $dx$ represents a change in $x$.
If $z=f(x,y)$, we define the differential of $f$ to be 
$$df= \frac{\partial f}{\partial x}dx+ \frac{\partial f}{\partial y}dy,$$
or in short-hand notation $df=f_xdx+f_ydy$, 
where $dx$ and $dy$ are independent variables which represent changes in $x$ and $y$.
\end{definition}

In this problem you will use differential notation to discover the derivative of a function in high dimensions.
\begin{problem}%
In each problem below, your job is to find a matrix $M$ so that the matrix product is the same as the corresponding differential notation. 
\begin{enumerate}
 \item  Let $z=f(x,y)$. Find a matrix $M$ so that 
$$df=f_xdx+f_ydy=M\begin{bmatrix}dx\\dy\end{bmatrix}.$$
 \item  Let $w=f(x,y,z)$. Find a matrix $M$ so that 
$$df=f_xdx+f_ydy+f_zdz=M\begin{bmatrix}dx\\dy\\dz\end{bmatrix}.$$
 \item  Let $\vec r(u,v)=(x,y,z)$. Find a matrix $M$ so that 
$$d\vec r=\frac{\partial \vec r}{\partial u}du+\frac{\partial \vec r}{\partial v}dv=M\begin{bmatrix}du\\dv\end{bmatrix}.$$
\end{enumerate}
\end{problem}

\begin{definition}\marginpar{The derivative of a function $Df$ is given many names in the literature.  It's called the total derivative, the matrix derivative, the Jacobian, the Jacobian matrix, and more. We'll just call $Df$ the derivative.}
The derivative of a function $\vec f:\R^n\to \R^m$, where $\vec y=\vec f(\vec x)$, is a matrix, written $D\vec f$ and read ``the derivative of $f$''. The columns of the matrix are the partial derivatives of the function. The order in which you list the input variables of $f$ is precisely the order in which the partials occur in the columns of the matrix.

 This matrix $D\vec f$ gives the best possible linear approximation to changes in the outputs, based upon changes in the inputs. We write the previous sentence symbolically as $d\vec y = D\vec f d\vec x$. 
\end{definition}
In first semester calculus we wrote the differential notation $dy=f'dx$.  Now put a vector above each variable, and change $f'$ from a number (a one-by-one matrix) to a matrix. This results in the differential notation $d\vec y = D\vec f d\vec x$ which is valid in all dimensions. 

Remember, to find the derivative of a function, compute all the partial derivatives and then place them in the columns of the matrix. Every variable gets a column. {\it Every variable gets a column. {\bf Every variable gets a column.}} 

\begin{problem}
\marginpar{This \derivativehomeworklink{handwritten file} has 6 problems, together with solutions, that you can use as extra practice.}
 For each function below, state the dimensions of the domain and codomain (inputs and outputs) and write the function in the form $f:\R^n\to R^m$. Then find the derivative. How does the number of rows and columns relate to $n$ and $m$? Remember, every variable gets a column. \marginpar{I'll have 4 people present this one in class.}
\begin{enumerate}
 \item $f(x,y)=x^2+4xy+y^3$
 \item $f(x,y,z)=x^2-yz^3$
 \item $\vec r(t)=(\cos t, \sin t)$ (Remember to place vectors in columns.)
 \item $\vec r(t)=(\cos t, \sin t,t)$
 \item $\vec r(a,t)=(a\cos t, a\sin t,t)$
 \item $\vec T(r,\theta)=(r\cos \theta, r\sin \theta)$
 \item $\vec F(x,y)=(2x+3y,4x+5y)$
 \item $\vec F(x,y,z)=(2x+3y-5z,4x+5y+z^2, xyz)$
\end{enumerate}
\end{problem}

Once we have the derivative, almost every idea from first semester calculus can be generalized to all dimensions by just replacing $f'$ with $Df$ and putting vector symbols above the inputs and outputs. As a first example, let's examing how tangent lines become tangent planes.

\begin{remark}
  In problem \ref{differentials give tangent lines}, we saw that the differential notation $dy=f'dx$ allowed us to write an equation of the tangent line to $y=f(x)=x^2$ at $x=3$. Here's a recap of what we did.
\begin{quote} The derivative is $f'(x)=2x$ which at $x=3$ equal $f'(3)= 6$. The graph of the function passes through the point $(3,f(3)) = (3,9)$. If $(x,y)$ is any point on the tangent line, then the change from $(3,9)$ to $(x,y)$ is given by $(dx,dy)=(x,y)-(3,9)=(x-3,y-9)$.  Differential notation then says $dy=f'(3)dx$ or that $(y-9)=6(x-3)$.  
\end{quote}
Tangent lines pop out instantly from differential notation. Tangent planes will ``pop out'' too, as well as tangent objects in any dimension. 
\end{remark}


\begin{problem}
Read the remark above. Then give an equation of the tangent plane to $f(x,y)=9-x^2-y^2$ at $(2,1)$ by using differential notation. Try doing so without using the steps below, rather just mimic what we did above. If you need the following steps, then use them. Compare with problem \ref{cake plane introduction}.
\begin{enumerate}
 \item Find $Df(x,y)$ and then $Df(2,1)$. You should have a matrix.
 \item Find the point $(2,1,f(2,1))$ on the graph of the surface.
 \item If $(x,y,z)$ is any point on the tangent plane, find the change $(dx,dy,dz)$ from $(2,1, f(2,1))$ to $(x,y,z)$ (subtract vectors).
 \item We'll use differential notation to finish this problem. We want to generalize $dy=f'dx$ (a change in outputs equals the derivative times a change in inputs), so we will use the notation $d\vec y = D\vec fd\vec x$. Recall the following. 
\begin{itemize} 
\item  The inputs to $z=f(x,y)$ are $x$ and $y$ (so the input vector is $\vec x=(x,y)$).  The output is $z$ (so the output vector is $\vec y= (z)$). 
\item The change in inputs is $(dx,dy)$.  The change in outputs is $(dz)$. 
\item The differential notation $d\vec y=D\vec f\ dx$ becomes $\begin{bmatrix}dz\end{bmatrix}=Df\begin{bmatrix}dx \\ dy\end{bmatrix}$. A change in the output $z$ equals the derivative times a change in the inputs $x$ and $y$.
\end{itemize}
Now use the differential notation $\begin{bmatrix}dz\end{bmatrix}=Df\begin{bmatrix}dx \\ dy\end{bmatrix}$ to write a matrix equation of the tangent plane (use $Df$ from part 1). Then perform the matrix multiplication. Compare with problem \ref{cake plane introduction}.
\end{enumerate}
\end{problem}

\begin{problem}
  Suppose $z=f(x,y)$ has a derivative $Df(x,y)$. Use differential notation to give an equation of the tangent plane to the surface at $(x,y)=(a,b)$. Multiply out any matrix products. What is a normal vector to the plane. Compare with problem \ref{general tangent plane with partials}.
\end{problem}

\section{The Chain Rule}

Let's recall the chain rule from first semester calculus. 

\begin{theorem}[The Chain Rule]
 Let $x$ be a real number and $f$ and $g$ be functions of a single real variable. Suppose $f$ is differentiable at $g(x)$ and $g$ is differentiable at $x$. The derivative of $f\circ g$ at $x$ is 
$$(f\circ g)'(x) = \frac{d}{dx}(f\circ g)(x) = f'(g(x))\cdot g'(x).$$
\end{theorem}

Some people remember the theorem above as ``the derivative of a composition is the derivative of the outside (evaluated at the inside) multiplied by the derivative of the inside.'' If $u=g(x)$, we sometimes write $\ds \frac{df}{dx}=\frac{df}{du}\frac{du}{dx}$. The following problem is designed to help you master the notation.

\begin{problem}\label{chain rule review problem}
 Suppose we know that $\ds f'(x) = \frac{\sin(x)}{2x^2+3}$ and $g(x)=\sqrt{x^2+1}$. Notice we don't know $f(x)$.  This is actually quite common in real life, as we can often measure how something changes (a derivative) without knowing a function for the something.
\begin{enumerate}
 \item What is $f'(x)$ and $g'(x)$?
 \item What is the difference between $f'(x)$ and $f'(g(x))$? State $f'(g(x))$.
 \item Use the chain rule to compute $(f\circ g)'(x)$.
\end{enumerate}
\end{problem}

We now jump to high dimensions. If I want to write $\vec f(\vec g(\vec x))$, then $\vec x$ must be a vector in the domain of $g$.  After computing $\vec g(\vec x)$, we must get a vector that is in the domain of $f$. 

\begin{problem}\label{horse track chain rule introduction}
 Consider $f(x,y)=9-x^2-y^2$ and $\vec r(t)=(2\cos t, 3\sin t)$. For this problem, imagine the following scenario.  A horse is running around outside in the cold. The horse's position at time $t$ is given by the elliptical path $\vec r(t)$. The temperature of the air at any point $(x,y)$ is given by $T=f(x,y)$.  
\begin{enumerate}
 \item At time $t=0$, what is the horse's position $\vec r(0)$, and what is the temperature $f(\vec r(0))$ at that position. Find the temperatures at $t=\pi/2$, $t=\pi$, and $t=3\pi/2$ as well. 
 \item In the plane, draw the path of the horse for $t\in [0,2\pi]$. Then, on the same 2D graph, include a contour plot of $f$. Make sure you include the level curves that pass through the points addressed above. (See  \ref{parametric curve in plane example} and \ref{cake level curves plot} if you need help.) At the points addressed in (a), write the temperature on the curve.
 \item\marginpar{This idea will lead to Lagrange multipliers in the Optimization chapter later in the semester.}%
 As the horse runs around, the temperature of the air around the horse is constantly changing. 
At which $t$ does the temperature around the horse reach a maximum?  A minimum?  Explain, using your graph. 
 \item As the horse moves past the point at $t=\pi/4$, is the temperature of the surrounding air increasing or decreasing? Use your graph to explain.
 \item Draw the 3D surface plot of $f$. In the $xy$-plane of your 3D plot (so $z=0$) add the path of the horse. In class, we'll project the path of the horse up into the 3D surface (give it a try yourself first). 
\end{enumerate}
\end{problem}

\begin{problem}
 Consider $f(x,y)=9-x^2-y^2$ and $\vec r(t)=(2\cos t, 3\sin t)$, which means $x=2\cos t$ and $y=3\sin t$.
\begin{enumerate}
 \item\marginpar{Try to always remember the following summary of differential notation: a change in the outputs equals the derivative times a change in the inputs.}%
For the function $\vec r(t)=(x,y)$, the input is $t$ and the outputs are $x$ and $y$.  So differential notation  states that 
$$\begin{pmatrix}dx\\dy\end{pmatrix}=D\vec r(t)\begin{pmatrix}dt\end{pmatrix}.$$
 Compute $D\vec r(t)$.
 \item For the function $T=f(x,y)$, the inputs are $x$ and $y$, and the output is temperature $T$. Differential notation  states that 
$$\begin{pmatrix}dT\end{pmatrix}=Df(x,y)\begin{pmatrix}dx\\dy\end{pmatrix}.$$
 Compute $Df(x,y)$.
 \item We have $\begin{pmatrix}df\end{pmatrix}=Df(x,y)\begin{pmatrix}dx\\dy\end{pmatrix}$ and $\begin{pmatrix}dx\\dy\end{pmatrix}=D\vec r(t)\begin{pmatrix}dt\end{pmatrix}.$ If $dt=1$ (so we increase $t$ by 1 unit), what are $dx$ and $dy$? Using these values of $dx$ and $dy$, what is the change in temperature $dT$? 
Recall that slope is rise over run.  So if $dt=1$, then $dT=dT/1=dT/dt$ gives us the derivative of temperature with respect to time. Replace any $x$ or $y$ in your final answer with what they equal along the curve $\vec r$, namely $x=2\cos t$ and $y=2\sin t$.
 \item Compute the matrix product $Df(x,y)\cdot D\vec r(t)$, and then substitute $x=2\cos t$ and $y=2\sin t$.
 \item What is $df/dt$ at $t=\pi/4$? Is it positive or negative? Compare with part (d) of the previous problem.
\end{enumerate}
\end{problem}

\begin{problem}
 Consider $f(x,y)=9-x^2-y^2$ and $\vec r(t)=(2\cos t, 3\sin t)$.
\begin{enumerate}
 \item Writing $\vec r(t)=(2\cos t, 3\sin t)$ means $x=2\cos t$ and $y=3\sin t$. In $f(x,y)$, replace $x$ and $y$ with what they are in terms of $t$. This will give you $f$ as a function of $t$. 
 \item Construct a graph of $f(t)$ (feel free to use software here). From your graph, at what time values do the maximums and minimums occur?
 \item Compute $df/dt$ (the derivative as you did in first semester calculus).
 \item What is $df/dt$ at $t=\pi/2$?
 \item Compare your work with the previous problem.
\end{enumerate}
\end{problem}

The previous 3 problems all focused on the exact same problem.  The first tackled the problem graphically, showing  what it means to write $(f\circ \vec r)(t)=f(\vec r(t))$. The second tackled the problem by considering matrix derivatives.  The third reduced the problem to first semester calculus.  In all three cases, we wanted to understand the following problem.
\begin{quote}
 If $z=f(x,y)$ is a function of $x$ and $y$, and both $x$ and $y$ are functions of $t$, so in vector form we can write $\vec r(t)=(x(t),y(t))$, then find how quickly $f$ changes as you change $t$. In other words, what is the derivative of $f$ with respect to $t$. Notationally, we seek $\ds \frac{df}{dt}$ which formally is written $\ds \frac{d}{dt}[f(x(t),y(t))]$ or $\ds \frac{d}{dt} [f(\vec r(t))].$
\end{quote}
The second problem above gave us an example of the following generalization of the chain rule.
\begin{theorem}[The Chain Rule]
 Let $\vec x$ be a vector and $\vec f$ and $\vec g$ be functions so that the composition $\vec f(\vec g(\vec x))$ makes sense (the output of $g$ can be used as an input to $f$). Suppose $\vec f$ is differentiable at $\vec g(\vec x)$ and $\vec g$ is differentiable at $\vec x$. The derivative of $\vec f\circ \vec g$ at $\vec x$ is 
$$D(\vec f\circ \vec g)(\vec x) = D\vec f(\vec g(\vec x))\cdot D\vec g(\vec x).$$
\end{theorem}
This is the exact same as the chain rule in first semester calculus.  The only difference is that now we have vectors above every variable and function, and we replaced the one-by-one matrices $f'$ and $g'$ with potentially larger matrices $Df$ and $Dg$. If everything is written in vector notation, the chain rule in all dimensions is the same as the chain rule in one dimension.

\begin{problem}\marginpar{See 14.4: 1-6 for more practice.}%
 Suppose $f(x,y) = x^2+xy$ and $x=2t+3$ and $y=3t^2+4$.
 \begin{enumerate}
  \item Rewrite the parametric equations $x=2t+3$ and $y=3t^2+4$ in vector form, so we can apply the chain rule. This means you need to create a function $\vec r(t) = (x,y)$.
  \item Compute the derivatives $Df(x,y)$ and $Dr(t)$. 
  \item The chain rule states that $D(f\circ \vec r)(t) = Df(\vec r(t))D\vec r(t)$. What is the difference between $Df(x,y)$ and $Df(r(t))$. [Hint: see problem \ref{chain rule review problem}.]
  \item Use the chain rule to compute $D(f\circ r)(t)$. What is $df/dt$?
  \item Now, without any matrix multiplication, replace $x$ and $y$ in $f=x^2+xy$ with what they are in terms of $t$, and then use first semester calculus to find $df/dt$.
 \end{enumerate}
\end{problem}

\begin{problem}\marginpar{See 14.4: 7-12 for more practice.}%
 Suppose $f(x,y,z) = x+2y+3z^2$ and $x=u+v$, $y=2u-3v$, and $z=uv$.  This means that changing $u$ and $v$ should cause $f$ to change. Our goal is to find $\partial f/\partial u$ and $\partial f/\partial v$. Try doing this problem without using the steps below, as you are just repeating the steps above.
 \begin{enumerate}
  \item Rewrite the parametric equations for $x,y,$ and $z$ in vector form $\vec r(u,v)=(x,y,z)$. If you were to graph $\vec r$, what kind of graph would you make?
  \item Compute $Df(x,y,z)$ and $Dr(u,v)$.  
  \item Use the chain rule (matrix multiplication) to find $D(f\circ r)(u,v)$.  Notice that since this composite function has 2 inputs, namely $u$ and $v$, we should expect to get two columns when we are done.
  \item What are $\partial f/\partial u$ and $\partial f/\partial v$? 
 \end{enumerate}
\end{problem}

\begin{problem}
 Suppose $\vec F(s,t) = (2s+t,3s-4t,t)$ and $s=3pq$ and $y=2p+q^2$.  This means that changing $p$ and $q$ should cause $\vec F$ to change. Our goal is to find $\partial \vec F/\partial p$ and $\partial \vec F/\partial q$. Note that since $\vec F$ is a vector valued function, you should get out vectors for these two partial derivatives. Try doing this problem without using the steps below, as you are just repeating the steps above.
 \begin{enumerate}
  \item Rewrite the parametric equations for $s$ and $t$ in vector form.
  \item Compute $D\vec F(s,t)$ and the derivative of your vector function from (a).  
  \item Use the chain rule (matrix multiplication) to find the derivative of $\vec F$ with respect to $p$ and $q$.  How many columns should we expect to have when we are done multiplying matrices?
  \item What are $\partial \vec F/\partial p$ and $\partial \vec F/\partial q$? 
 \end{enumerate}
\end{problem}


\begin{problem}\marginpar{See 14.4: 13-24 for more practice. However, don't use a ``branch diagram,'' rather use matrix multiplication. The branch diagram is just a way to express matrix multiplication without having to introduce matrices.}%
 Suppose $w=f(x,y,z)$ and $x,y,z$ are all function of one variable $t$ (so $x=g(t), y=h(t), z=k(t)$).  
 Find a general formula for $dw/dt$ that involves partials of $f$ and derivatives of $x$, $y$, and $z$. Try doing this problem without using the steps below, as you are just repeat the steps above.
\begin{enumerate}
 \item Rewrite the parametric equations for $x$, $y$, and $z$ in vector form $\vec r(t) = (x,y,z)$.
 \item Compute $Dw(x,y,z)$ and $D\vec r(t)$. 
 \item Multiply the matrices together to get $D(w\circ r)(t)$.  The matrix should have one entry. State what $dw/dt$ equals.
\end{enumerate}
\end{problem}


\begin{problem}
 Suppose $w=f(s,t)$ and $s$ and $t$ are function of $u$, $v$ and $w$.  Use the chain rule to give a general formula for $\partial w/\partial u$, $\partial w/\partial v$, $\partial w/\partial w$. 
\end{problem}

You've now got the key ideas needed to use the chain rule in all dimensions. You'll find this shows up everywhere in upper level math, physics, and engineering courses. The following problem will show you how you can use the general chain rule to get an extremely quick way to perform implicit differentiation from first semester calculus.

\begin{problem}\marginpar{See 14.4: 25-32 to practice using the formula you developed.  To practice the idea developed in this problem, show that if $w=F(x,y,z)$ is held constant at $w=c$ and we assume that $z=f(x,y)$ depends on $x$ and $y$, then $\frac{\partial z}{\partial x} = -\frac{F_x}{F_z}$ and $\frac{\partial z}{\partial y} = -\frac{F_y}{F_z}$. This is done on page 798 at the bottom. }%
 Suppose $z=f(x,y)$.  If $z$ is held constant, this produces a level curve. As an example, if $f(x,y) = x^2+3xy-y^3$ then $5=x^2+3xy-y^3$ is a level curve. Our goal in this problem is to find $dy/dx$ in terms of partial derivatives of $f$.
\begin{enumerate}
 \item Suppose $x=x$ and $y=y(x)$, so $y$ is a function of $x$.  We can write this in parametric form as $\vec r(x) = (x,y(x))$. We now have $z=f(x,y)$ and $\vec r(x)=(x,y(x))$.  Compute both $Df(x,y)$ and $D\vec r(x)$. 
 \item Use the chain rule to compute $D(f(\vec r(x)))$. What is $dz/dx$, i.e. $df/dx$?
 \item Since $z$ is held constant, we know that $dz/dx=0$. Use this fact, together with part (b) to explain why $\ds \frac{dy}{dx} = -\frac{f_x}{f_y} = -\frac{\partial f/ \partial x}{\partial f/ \partial y}$.
 \item For the curve $5=x^2+3xy-y^3$, use this formula to compute $dy/dx$.
\end{enumerate}
  
\end{problem}

\note{I would really like to have an example that uses three functions, so they have to multiply 3 matrices together. This would show them that they can just keep on using the chain rule, again and again and again.  Then if someone wants to use the tree rule, this will show them how much simpler matrix multiplication is.  The tree rule gets pretty hairy.}

